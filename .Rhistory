1-pnorm(abs(z[1,3]))
p$2*(1-pnorm(abs(z)))
p<-2*(1-pnorm(abs(z)))
p
coef(malli)
z
summary(malli)
malli.p<-p
malli.z<-z
rm(p,z,i)
malli.z
Anova(malli)
summary(malli2)
malli.z
install.packages("polytomous")
arr
mantelhaen.test(arr)
nouns
adj
adj2
verbs
mantelhaen.test(array(dim=c(2,5,2),c(verbs,nouns)))
mantelhaen.test(array(dim=c(2,5,2),c(adj2,nouns)))
adj2
nouns
fix(nouns)
fakenouns<-nouns
fix(fakenouns)
mantelhaen.test(array(dim=c(2,5,2),c(adj2,fakenouns)))
fisher.test(adj2)
fisher.test(adj)
fisher.test(nouns)
?mantelhaen.test
arr
cmr<-mantelhaen.test(arr)
summary(cmr)
str(cmr)
rm(cmr)
cmh<-mantelhaen.test(arr)
cmh
arr.mn<-array(dim=c(2,2,3),c(298,120,1043,953,57,7,154,42,30,6,118,77))
arr.mn
mantelhaen.test(arr.mn)
mh<-mantelhaen.test(arr.mn)
summary(mh)
mh
str(mh)
mh<-mantelhaen.test(arr.mn,correct = FALSE)
mh<-mantelhaen.test(arr.mn)
mantelhaen.test(arr,correct = FALSE)
mantelhaen.test(arr.mn,correct = FALSE)
mh2<-mantelhaen.test(arr.mn,correct = F)
mh
mh2
mh$statistic
mh$p.value
round(mh$p.value,digits=15)
round(mh$p.value,digits=20)
round(mh$p.value,digits=25)
round(mh$p.value,digits=30)
mh$p.value*1000000
mh$p.value*1000000000
mh$p.value*1000000000000
mh
all<-matrix(ncol=2,c(167,64,193,58,25,11,309,259,1006,813))
all
all<-matrix(ncol=5,c(167,64,193,58,25,11,309,259,1006,813))
all
chisq.test(all)
?chisq.test
cmh
prop.table(nouns,1)
prop.table(verbs,1)
prop.table(adj,1)
adj2
adj
chisq.test(adj)
fisher.test(adj)
fisher.test(adj2)
?fisher.test
arr.mn
tapply(arr.mn,sum)
all
all.mn<-matrix(ncol=2,c(385,133,1315,1072))
all.mn
chisq.test(mn)
chisq.test(all.mn)
chisq.test(all.mn, correct=F)
arr.mn
addmargins(arr.mn)
mantelhaen.test(arr.mn)
mantelhaen.test(arr.mn,correct=F)
arr.mn
all.mn
addmargins(all.mn)
(1072/1205)/(1315/1700)
(1072/133)/(1315/385)
arr.mn
(953/120)/(1043/298)
(42/7)/(154/57)
(77/6)/(118/30)
mantelhaen.test(arr.mn)
all
((309+1006)/1700)/((259+813)/1205)
((259+813)/1205)/((309+1006)/1700)
all.mn
mn
arr.mn
all.mn
(1072/133)/(1315/385)
(1072/1205)/(1315/1700)
all
((259+813)/(64+58+11))/((309+1006)/(167+193+25))
verbs
all.mn
arr.mn
(953/120)/(1043/298)
(42/7)/(154/57)
(77/6)/(118/30)
dbinom(5,10,c(.5,.5))
dbinom(5,10,.5)
fisher.test(verbs[,1:3])
verbs[,1:3]
chisq.test(verbs[,1:3])
fisher.test(nouns[,1:3])
fisher.test(adj[,1:2])
adj[,1:2]
adj
arr
mantelhaen.test(arr[,1:3,])
mandverb<-verbs[,1:3]
mandnoun<-nouns[,1:3]
mandadj<-adj2[,1:3]
mandverb
mandnoun
mandadj
addmargins(mandverb)
rowSums(mandverb[1,])
rowSums(mandverb)
rowSums(mandverb)[1]
mandverb.ex<-rbind(mandverb[1,],mandverb[2,]*(rowSums(mandverb)[1]/rowSums(mandverb[2])))
mandverb.ex<-rbind(mandverb[1,],mandverb[2,]*(rowSums(mandverb)[1]/rowSums(mandverb)[2]))
mandverb.ex
addmargins(mandnoun)
mandnoun.ex<-mandnoun
mandnoun.ex[2,]<-mandnoun[2,]*(57/7)
mandadj.ex<-mandadj
addmargins(mandadj)
mandadj.ex[2,]<-mandadj[2,]*(30/6)
mandverb.ex
addmargins(mandverb.ex)
addmargins(mandnoun.ex)
addmargins(mandadj.ex)
mantelhaen.test(array(dim=c(2,3,3),c(mandverb,mandadj,mandnoun)))
fisher.test(mandverb.ex)
fisher.test(round(mandverb.ex))
fisher.test(round(mandnoun.ex))
fisher.test(round(mandadj.ex))
mantelhaen.test(array(dim=c(2,3,3),c(mandverb.ex,mandnoun.ex,mandadj.ex)))
mandnoun.ex
fisher.test(mandnoun.ex)
fisher.test(round(mandnoun.ex))
mandall<-array(dim=c(2,2,3),c(mandverb,mandnoun,mandadj))
mandall
mantelhaen.test(mandall)
mandall<-array(dim=c(2,3,3),c(mandverb,mandnoun,mandadj))
mandall
mantelhaen.test(mandall)
adj2
nouns
str(nouns)
is(nouns)
mantelhaen.test(array(c(adj2,nouns)))
mantelhaen.test(array(dim=c(2,5,2),c(adj2,nouns)))
mandnoun
fisher.test(mandnoun)
summary(mh)
arr.mn
mantelhaen.test(arr.mn)
chisq.test(arr.mn[,,2])
mantelhaen.test(arr.mn[,,2:3])
arr.mn[,,2]
test1<-matrix(ncol=2,2,c(0,0,0,0))
fix(test1)
test1<-matrix(ncol=2,c(0,0,0,0))
fix(test1)
test1
chisq.test(test1)
test2<-test1
fix(test2)
test2
test1
chisq.test(test1)
chisq.test(test2)
mantelhaen.test(array(dim=c(2,2,2),c(test1,test2)))
over<-test1+test2
over
chisq.test(over)
test1
test2
mantelhaen.test(array(dim=c(2,2,2),c(test1,test2)))
chisq.test(over)
test3<-fix(test2)
test3
chisq.test(test1+test2)
test1+test2
test1
test2
fix(test2)
test3<-test2
fix(test3)
test3
test1+test3
chisq.test(test1+test3)
mantelhaen.test(array(dim=c(2,2,2),c(test1,test2)))
mantelhaen.test(array(dim=c(2,2,2),c(test1,test3)))
fakenouns
nouns
fakenouns
nouns
fakenouns
fisher.test(nouns)
fisher.test(fakenouns)
fix(fakenouns)
addmargins(nouns)
fix(fakenouns)
addmargins(nouns)
addmargins(fakenouns)
chisq.test(fakenouns)
fisher.test(fakenouns)
arr
mantelhaen.test(arr)
mantelhaen.test(arr(dim=c(2,5,3),c(verbs,fakenouns,adj2)))
mantelhaen.test(array(dim=c(2,5,3),c(verbs,fakenouns,adj2)))
fakearr<-array(dim=c(2,5,3),c(verbs,fakenouns,adj2))
fakearr
arr
fakearr
mantelhaen.test(arr)
mantelhaen.test(fakearr)
fakenouns
arrmagins(fakearr)
addmargins(fakearr)
addmargins(arr)
addmargins(fakearr)
addmargins(arr)[4]
addmargins(arr)[,,4]
addmargins(arr)[,,4]
addmargins(fakearr)[,,4]
verbs+nouns+adj2
verbs+fakenouns+adj2
all
chisq.test(all)
mantelhaen.test(arr)
mantelhaen.test(fakearr)
verbs+fakenouns+adj2
addmargins(fakearr)
addmargins(fakearr)[,,4]
addmargins(arr)[,,4]
verbs+fakenouns+adj2
chisq.test(verbs+fakenouns+adj2)
mantelhaen.test(arr)
mantelhaen.test(arr.mn)
test1
test1
chisq.test(test1)
chisq.test(test2)
fix(test1)
test2
test1
chisq.test(test1)
chisq.test(test2)
fix(test1)
test1
test2
fix(test2)
test2
chisq.test(test1)
chisq.test(test2)
fix(test2)
chisq.test(test2)
test1+test2
chisq.test(test1+test2)
mantelhaen.test(arr(dim=c(2,2,2),c(test1,test2)))
chisq.test(test1+test2)
chisq.test(test1)
chisq.test(test2)
chisq.test(test1+test2)
mantelhaen.test(array(dim=c(2,2,2),c(test1,test2)))
test1
test2
test1+test2;addmargins(array(dim=c(2,2,2),c(test1,test2)))[,,3]
chisq.test(test1+test2)
mantelhaen.test(array(dim=c(2,2,2),c(test1,test2)))
crosstab2<-matrix(ncol=2, c(57,87,118,185),
dimnames = list(c("exposed","non-exposed"),c("ill","healthy")))
(stratum1<-matrix(ncol=2, c(16,50,80,165), dimnames=
list(c("exposed","non-exposed"),"Stratum 1"=c("ill","healthy"))))
(stratum2<-matrix(ncol=2,
c(41,37,38,20),dimnames=
list(c("exposed","non-exposed"),"Stratum 2"=c("ill","healthy"))))
crosstab2
stratum1+stratum2
chisq.test(crosstab2)
bothstrata<-array(dim=c(2,2,2),c(stratum1,stratum2))
bothstrata
stratum1+stratum2
crosstab2
chisq.test(stratum1+stratum2)
mantelhaen.test(bothstrata)
mantelhaen.test(bothstrata,correct = F)
summary(mallinom)
summary(logmalli)
summary(logmalli2)
multpois
cbind(multpois,predict(logmalli2,newdata=multpois,type="response"))
cbind(multpois,round(predict(logmalli2,newdata=multpois,type="response"),digits=0))
Anova(logmalli2)
Anova(mallinom2)
Anova(mallinom)
Anova(malli2)
Anova(malli)
summary(malli)
Anova(logmalli2)
anova(logmalli2)
anova(logmalli2,test = "LRT")
anova(logmalli2,test = "Chisq")
summary(logmalli2)
Anova(logmalli2)
summary(malli)
Anova(malli)
arr
mantelhaen.test(arr)
all
chisq.test(all)
1592369/2887
1592369/5432400
1/(1592369/5432400)
5432400/1592369
adj2
mandadj
mandnoun
fisher.test(mandadj)
fisher.test(mandnoun)
mandnoun
all
880/1280
(versions<-matrix(ncol=5,c(64,57,58,92,11,24,259,240,813,734)))
addmargins(versions)
chisq.test(versions)
save.image("C:/Users/juho/Desktop/ArticleData.RData")
setwd(dir="c:/users/juho/desktop")
setwd("ALR")
knitr::opts_chunk$set(echo = TRUE)
(e1<-matrix(ncol=4,
c(2.5634,0.7579,0.5033,NA,0.2071,0.3137,NA,0.2873,-12.380,
NA,1.800,1.179,2*pnorm(-12.380),0.0157,0.0719,NA),
dimnames=list(c("(Intercept)","C","D","G"),c("Estimate","Std.Err","z-value","Pr(>|z|)"))))
(e1["C","z-value"] <- e1["C","Estimate"] / e1["C","Std.Err"])
e1
(e1["D","Std.Err"] <- e1["D","Estimate"] / e1["D","z-value"])
e1
(e1["G","Estimate"] <- e1["G","z-value"] * e1["G","Std.Err"])
e1
(e1["G","Pr(>|z|)"] <- 2*(1-pnorm(abs(e1["G","z-value"]))))
zplot <- function(critical) {
critical <- round(critical, 5)
z <- c(-critical, critical)
par(mar = c(7,4,5,4))
x <- (-40:40)/10
y <- dnorm(x)
main = paste("The N(0, 1) distribution \n z = ",critical)
plot(x, y, type = "l", xaxt = "n", ylab = "n", main = main)
axis(1, at = c(-3,  0,  3))
axis(1, at = round(z, 2) , col.ticks = "red", las = 2)
# highlight critical regions, add matching percentages
x1 <- x[x<=min(z)]; x2 <- x[x>=max(z)]
a <- round(pnorm(min(z)),5)
polygon(c(min(x1),x1, max(x1), min(x2), x2, max(x2)),
c(0, dnorm(x1),0, 0, dnorm(x2), 0), col = "grey60")
text(x = c(-3.5, 3.5), y = c(0.08,0.08), labels = paste0(a*100,"%"), cex = 1.5)
text(x = 0, y = 0.08, labels=paste0(100*(1-a*2),"%"), cex = 1.5)
}
zplot(e1["G","z-value"])
addmargins(mtable<-matrix(ncol = 2,c(27,44,95,443),dimnames =
list(c("c1","c0"),c("ill","healthy"))))
CHD <- c(rep(1,times=71),rep(0,times=538))
cat.high <- c(rep(1,times=27),rep(0,times=44),rep(1,times=95),rep(0,times=443))
catecholamine<-glm(CHD ~ cat.high, family = binomial(link="logit"))
summary(catecholamine)
(a0e0<-matrix(ncol = 2, c(1,17,7,257),
dimnames=list(c("c1","c0"),a0e0=c("ill","healthy"))))
(a0e1<-matrix(ncol = 2, c(3,7,14,52),
dimnames=list(c("c1","c0"),a0e1=c("ill","healthy"))))
(a1e0<-matrix(ncol = 2, c(9,15,30,107),
dimnames=list(c("c1","c0"),a1e0=c("ill","healthy"))))
(a1e1<-matrix(ncol = 2, c(14,5,44,27),
dimnames=list(c("c1","c0"),a1e1=c("ill","healthy"))))
type1<-data.frame(ill=1,high.cat=1,over54=0,ECG.bad=0) #a0e0c1 -- ill
type2<-data.frame(ill=rep(1,times=17),high.cat=0,over54=0,ECG.bad=0) #a0e0c1 -- ill
type3<-data.frame(ill=rep(0,times=7),high.cat=1,over54=0,ECG.bad=0) #a0e0c0 -- healthy
type4<-data.frame(ill=rep(0,times=257),high.cat=0,over54=0,ECG.bad=0) #a0e0c1 -- healthy
type5<-data.frame(ill=rep(1,times=3),high.cat=1,over54=0,ECG.bad=1) #a0e1c1 -- ill
type6<-data.frame(ill=rep(1,times=7),high.cat=0,over54=0,ECG.bad=1) #a0e1c0 -- ill
type7<-data.frame(ill=rep(0,times=14),high.cat=1,over54=0,ECG.bad=1) #a0e1c1 -- healthy
type8<-data.frame(ill=rep(0,times=52),high.cat=0,over54=0,ECG.bad=1) #a1e1c0 -- healthy
type9<-data.frame(ill=rep(1,times=9),high.cat=1,over54=1,ECG.bad=0) #a1e0c1 -- ill
type10<-data.frame(ill=rep(1,times=15),high.cat=0,over54=1,ECG.bad=0) #a1e0c0 -- ill
type11<-data.frame(ill=rep(0,times=30),high.cat=1,over54=1,ECG.bad=0) #a1e0c1 -- healthy
type12<-data.frame(ill=rep(0,times=107),high.cat=0,over54=1,ECG.bad=0) #a1e0c1 -- healthy
type13<-data.frame(ill=rep(1,times=14),high.cat=1,over54=1,ECG.bad=1) #a1e1c1 -- ill
type14<-data.frame(ill=rep(1,times=5),high.cat=0,over54=1,ECG.bad=1) #a1e1c0 -- ill
type15<-data.frame(ill=rep(0,times=44),high.cat=1,over54=1,ECG.bad=1) #a1e1c1 -- healthy
type16<-data.frame(ill=rep(0,times=27),high.cat=0,over54=1,ECG.bad=1) #a1e1c0 -- healthy
EvansData<-rbind(type1,type2,type3,type4,type5,type6,type7,type8,
type9,type10,type11,type12,type13,type14,type15,type16) #Concatenate
EvansData[sample(nrow(EvansData),size=10),] #View 10 randomly sampled rows
EvansModel<-glm(ill ~ high.cat+over54+ECG.bad, data = EvansData, family=binomial(link = "logit"))
summary(EvansModel)
Evans.4p <- glm(formula = ill ~ high.cat + over54 + ECG.bad + over54*ECG.bad,
data=EvansData, family=binomial(link="logit"))
summary(Evans.4p)
subsample1<-data.frame(Age=rep("<25",53),Education="Low",WantsMore="yes",bc.use=0)
subsample2<-data.frame(Age=rep("<25",6),Education="Low",WantsMore="yes",bc.use=1)
subsample3<-data.frame(Age=rep("<25",10),Education="Low",WantsMore="no",bc.use=0)
subsample4<-data.frame(Age=rep("<25",4),Education="Low",WantsMore="no",bc.use=1)
subsample5<-data.frame(Age=rep("<25",212),Education="High",WantsMore="yes",bc.use=0)
subsample6<-data.frame(Age=rep("<25",52),Education="High",WantsMore="yes",bc.use=1)
subsample7<-data.frame(Age=rep("<25",50),Education="High",WantsMore="no",bc.use=0)
subsample8<-data.frame(Age=rep("<25",10),Education="High",WantsMore="no",bc.use=1)
subsample9<-data.frame(Age=rep("25-29",60),Education="Low",WantsMore="yes",bc.use=0)
subsample10<-data.frame(Age=rep("25-29",14),Education="Low",WantsMore="yes",bc.use=1)
subsample11<-data.frame(Age=rep("25-29",19),Education="Low",WantsMore="no",bc.use=0)
subsample12<-data.frame(Age=rep("25-29",10),Education="Low",WantsMore="no",bc.use=1)
subsample13<-data.frame(Age=rep("25-29",155),Education="High",WantsMore="yes",bc.use=0)
subsample14<-data.frame(Age=rep("25-29",54),Education="High",WantsMore="yes",bc.use=1)
subsample15<-data.frame(Age=rep("25-29",65),Education="High",WantsMore="no",bc.use=0)
subsample16<-data.frame(Age=rep("25-29",27),Education="High",WantsMore="no",bc.use=1)
subsample17<-data.frame(Age=rep("30-39",112),Education="Low",WantsMore="yes",bc.use=0)
subsample18<-data.frame(Age=rep("30-39",33),Education="Low",WantsMore="yes",bc.use=1)
subsample19<-data.frame(Age=rep("30-39",77),Education="Low",WantsMore="no",bc.use=0)
subsample20<-data.frame(Age=rep("30-39",80),Education="Low",WantsMore="no",bc.use=1)
subsample21<-data.frame(Age=rep("30-39",118),Education="High",WantsMore="yes",bc.use=0)
subsample22<-data.frame(Age=rep("30-39",46),Education="High",WantsMore="yes",bc.use=1)
subsample23<-data.frame(Age=rep("30-39",68),Education="High",WantsMore="no",bc.use=0)
subsample24<-data.frame(Age=rep("30-39",78),Education="High",WantsMore="no",bc.use=1)
subsample25<-data.frame(Age=rep("40-49",35),Education="Low",WantsMore="yes",bc.use=0)
subsample26<-data.frame(Age=rep("40-49",6),Education="Low",WantsMore="yes",bc.use=1)
subsample27<-data.frame(Age=rep("40-49",46),Education="Low",WantsMore="no",bc.use=0)
subsample28<-data.frame(Age=rep("40-49",48),Education="Low",WantsMore="no",bc.use=1)
subsample29<-data.frame(Age=rep("40-49",8),Education="High",WantsMore="yes",bc.use=0)
subsample30<-data.frame(Age=rep("40-49",8),Education="High",WantsMore="yes",bc.use=1)
subsample31<-data.frame(Age=rep("40-49",12),Education="High",WantsMore="no",bc.use=0)
subsample32<-data.frame(Age=rep("40-49",31),Education="High",WantsMore="no",bc.use=1)
bc<-rbind(subsample1,subsample2,subsample3,subsample4,subsample5,subsample6,
subsample7,subsample8,subsample9,subsample10,subsample11,subsample12,subsample13,
subsample14,subsample15,subsample16,subsample17,subsample18,subsample19,subsample20,
subsample21,subsample22,subsample23,subsample24,subsample25,subsample26,subsample27,
subsample28,subsample29,subsample30,subsample31,subsample32)
#Make WantsMore a binary variable where 0=no and 1=yes:
bc$WantsMore<-as.numeric(bc$WantsMore); bc$WantsMore[bc$WantsMore==2]<-0
model1<-glm(bc.use ~ Age+Education+WantsMore, family=binomial(link="logit"), data=bc)
summary(model1) #Model summary
data.frame(exp(coef(model1))) #Odds ratios
model2<-glm(bc.use ~ Age*Education+Age*WantsMore+Education*WantsMore,
family=binomial(link="logit"), data=bc)
summary(model2) #Model summary
data.frame(exp(coef(model2))) #Odds ratios
library(boot)
ErrorRate<-function(Y,prob){mean(abs(Y-prob)>0.5)} #Define Error Rate
data.frame(Model1.TestingError = cv.glm(data=bc, glmfit=model1, cost=ErrorRate)$delta[1],
Model2.TestingError = cv.glm(data=bc, glmfit=model2, cost=ErrorRate)$delta[1])
subset1<-data.frame(Proximity=rep(1,times=77),Contact=1,Norms="Favorable",PositiveSentiment=1)
subset2<-data.frame(Proximity=rep(1,times=32),Contact=1,Norms="Favorable",PositiveSentiment=0)
subset3<-data.frame(Proximity=rep(1,times=30),Contact=1,Norms="Unfavorable",PositiveSentiment=1)
subset4<-data.frame(Proximity=rep(1,times=36),Contact=1,Norms="Unfavorable",PositiveSentiment=0)
subset5<-data.frame(Proximity=rep(1,times=14),Contact=0,Norms="Favorable",PositiveSentiment=1)
subset6<-data.frame(Proximity=rep(1,times=19),Contact=0,Norms="Favorable",PositiveSentiment=0)
subset7<-data.frame(Proximity=rep(1,times=15),Contact=0,Norms="Unfavorable",PositiveSentiment=1)
subset8<-data.frame(Proximity=rep(1,times=27),Contact=0,Norms="Unfavorable",PositiveSentiment=0)
subset9<-data.frame(Proximity=rep(0,times=43),Contact=1,Norms="Favorable",PositiveSentiment=1)
subset10<-data.frame(Proximity=rep(0,times=20),Contact=1,Norms="Favorable",PositiveSentiment=0)
subset11<-data.frame(Proximity=rep(0,times=36),Contact=1,Norms="Unfavorable",PositiveSentiment=1)
subset12<-data.frame(Proximity=rep(0,times=37),Contact=1,Norms="Unfavorable",PositiveSentiment=0)
subset13<-data.frame(Proximity=rep(0,times=27),Contact=0,Norms="Favorable",PositiveSentiment=1)
subset14<-data.frame(Proximity=rep(0,times=36),Contact=0,Norms="Favorable",PositiveSentiment=0)
subset15<-data.frame(Proximity=rep(0,times=41),Contact=0,Norms="Unfavorable",PositiveSentiment=1)
subset16<-data.frame(Proximity=rep(0,times=118),Contact=0,Norms="Unfavorable",PositiveSentiment=0)
contact<-rbind(subset1,subset2,subset3,subset4,subset5,subset6,subset7,subset8,subset9,subset10,
subset11,subset12,subset13,subset14,subset15,subset16)
con.model1<-glm(PositiveSentiment ~ Proximity+Contact+Norms,
family=binomial(link = "logit"), data=contact)
summary(con.model1)
exp(confint(con.model1))
con.model2<-glm(PositiveSentiment ~ Proximity*Contact+Proximity*Norms+Contact*Norms,
family=binomial(link="logit"),data=contact)
summary(con.model2)
con.model3<-glm(PositiveSentiment ~ Contact+Norms, family=binomial(link="logit"),data=contact)
anova(con.model1,con.model3,test = "LRT")
summary(con.model3)
exp(confint(con.model3))
data.frame(ConModel1.TestingError = cv.glm(data=contact, glmfit=con.model1, cost=ErrorRate)$delta[1],
ConModel2.TestingError = cv.glm(data=contact, glmfit=con.model2, cost=ErrorRate)$delta[1],
ConModel3.TestingError = cv.glm(data=contact, glmfit=con.model3, cost=ErrorRate)$delta[1])
head(bs)
head(bc)
summary(bc.use~Age+Education+WantsMore,data=bc)
?summary
library("LanguageR")
install.packages("languageR")
library("languageR", lib.loc="~/R/win-library/3.3")
summary(bc.use~Age+Education+WantsMore,data=bc)
